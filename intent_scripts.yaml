AwayModeOn:
  speech: 
    text: >
      {{ ['Initiating', 'Activating'] | random }} {{ ['Away Mode', 'shutdown sequence'] | random }}.
  action:
    - service: input_boolean.turn_on
      target:
        entity_id: input_boolean.away_mode
PartyModeOn:
  speech: 
    text: >
      {{ ['Initiating', 'Activating'] | random }} party mode.
  action:
    - service: input_boolean.turn_on
      target:
        entity_id: input_boolean.party_mode
PartyModeOff:
  speech: 
    text: >
      {{ ['Turning off', 'Dectivating'] | random }} party mode.
  action:
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.party_mode
CommandVacuum:
  speech:
    text: >
      {% if command == 'start' %}
        {{ ['Starting','Running','Initiating','Activating'] | random }} the vacuum.
      {% elif command == 'pause' %}
        Vacuum paused.
      {% elif command == 'stop' %}
        {{ ['Stopping','Deactivating'] | random }} the vacuum.
      {% else %}
        Returning vacuum to dock.
      {% endif %}
  action:
    - service: 'vacuum.{{ command }}'
      target:
        entity_id: vacuum.roborock_s7
VacuumStatus:
  speech:
    text: >
      The vacuum is {{ 'in trouble' if states('vacuum.roborock_s7') == 'error' else states('vacuum.roborock_s7') }}.
      {% if as_datetime(states('sensor.roborock_s7_last_clean_end')) > as_datetime(states('sensor.roborock_s7_last_clean_begin')) %}
        It cleaned {{states('sensor.roborock_s7_cleaning_area')) | float(0) | round(0)}} square metres for {{ states('sensor.roborock_s7_cleaning_time').split(':')[0] + ' hours and ' if states('sensor.roborock_s7_cleaning_time').split(':')[0] | int(0) > 0 else '' }}{{ states('sensor.roborock_s7_cleaning_time').split(':')[1] }} minutes and its last run ended {{ relative_time(as_datetime(states('sensor.roborock_s7_last_clean_end'))) }} ago.
      {% else %}
        Its last run started {{ states('sensor.roborock_s7_last_clean_begin') }} ago
      {% endif %}
CookingPreset:
  speech:
    text: >
      {% if is_state('switch.stove_main_power','on') %}
        {{ side | capitalize }} cooker set to {{ cooking_preset }}.
      {% else %}
        Please turn on the stove manually first.
      {% endif %}
  action:
    - variables:
        presets_power:
          'boil water': '7'
          'cook rice': '1'
          'stir fry': '4'
          'simmer': '1'
        presets_time:
          'boil water': 5
          'cook rice': 16
          'stir fry': 0
          'simmer': 0
    - condition: state
      entity_id: switch.stove_main_power
      state: 'on'
    - service: select.select_option
      data:
        option: '{{ side }}'
      target:
        entity_id: select.stove_current_burner
    - service: select.select_option
      data:
        option: '{{ presets_power[cooking_preset] }}'
      target:
        entity_id: select.stove_current_burner_power
    - service: number.set_value
      data:
        value: '{{ presets_time[cooking_preset] }}'
      target:
        entity_id: number.stove_current_burner_timer
SetCookerPower:
  speech:
    text: >
      {% if is_state('switch.stove_main_power','on') %}
        {{ side | capitalize }} cooker set to level {{ power }}.
      {% else %}
        Please turn on the stove manually first.
      {% endif %}
  action:
    - condition: state
      entity_id: switch.stove_main_power
      state: 'on'
    - service: select.select_option
      data:
        option: '{{ side }}'
      target:
        entity_id: select.stove_current_burner
    - service: select.select_option
      data:
        option: '{{ power }}'
      target:
        entity_id: select.stove_current_burner_power
SetCookerTimer:
  speech:
    text: >
      {% if is_state('switch.stove_main_power','on') %}
        {% if time == 0 %}
          {{ side | capitalize }} cooker timer deactivated.
        {% else %}
          {{ side | capitalize }} cooker timer set to {{ time }} {{ 'minutes' if time > 1 else 'minute' }}.
        {% endif %}
      {% else %}
        Please turn on the stove manually first.
      {% endif %}
  action:
    - condition: state
      entity_id: switch.stove_main_power
      state: 'on'
    - service: select.select_option
      data:
        option: '{{ side }}'
      target:
        entity_id: select.stove_current_burner
    - service: number.set_value
      data:
        value: '{{ time }}'
      target:
        entity_id: number.stove_current_burner_timer
SetCookerPowerTimer:
  speech:
    text: >
      {% if is_state('switch.stove_main_power','on') %}
        {% if power | int(0) == 0 %}
          {{ side | capitalize }} cooker deactivated.
        {% else %}
          {% if time == 0 %}
            {{ side | capitalize }} cooker set to level {{ power }}.
          {% else %}
            {{ side | capitalize }} cooker set to level {{ power }} for {{ time }} {{ 'minutes' if time > 1 else 'minute' }}.
          {% endif %}
        {% endif %}
      {% else %}
        Please turn on the stove manually first.
      {% endif %}
  action:
    - condition: state
      entity_id: switch.stove_main_power
      state: 'on'
    - service: select.select_option
      data:
        option: '{{ side }}'
      target:
        entity_id: select.stove_current_burner
    - service: select.select_option
      data:
        option: '{{ power }}'
      target:
        entity_id: select.stove_current_burner_power
    - service: number.set_value
      data:
        value: '{{ time }}'
      target:
        entity_id: number.stove_current_burner_timer
TurnOffCooker:
  speech:
    text: >
      {% if is_state('switch.stove_main_power','on') %}
        {{ side | capitalize }} cooker deactivated.
      {% else %}
        Please turn on the stove manually first.
      {% endif %}
  action:
    - condition: state
      entity_id: switch.stove_main_power
      state: 'on'
    - service: select.select_option
      data:
        option: '{{ side }}'
      target:
        entity_id: select.stove_current_burner
    - service: select.select_option
      data:
        option: '0'
      target:
        entity_id: select.stove_current_burner_power
CookerStatus:
  action:
    - condition: state
      entity_id: switch.stove_main_power
      state: 'on'
    - service: select.select_option
      data:
        option: '{{ side }}'
      target:
        entity_id: select.stove_current_burner
    - delay: 1
  speech:
    text: >
      {% set text = namespace(output = '') %}
      {% if is_state('switch.stove_main_power','on') %}
        {% set text.output = 'The ' + states('select.stove_current_burner') + ' cooker is on level ' + states('select.stove_current_burner_power') %}
        {% if states('number.stove_current_burner_timer') | int(0) == 0 %}
          {% set text.output = text.output + '.' %}
        {% elif states('number.stove_current_burner_timer') | int(0) == 1 %}
          {% set text.output = text.output + ' with 1 minute remaining.' %}
        {% else %}
          {% set text.output = text.output + ' with ' + states('number.stove_current_burner_timer') + ' minutes remaining.' %}
        {% endif %}
      {% else %}
        {% set text.output = 'The ' + side + ' cooker is off.' %}
      {% endif %}
      {{ text.output }}
